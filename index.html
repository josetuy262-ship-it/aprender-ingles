<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refold English App</title>
    <style>
        :root {
            --primary: #3b82f6;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
        }
        body { font-family: sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        /* Overlay de Inicio */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        /* Navegaci칩n */
        nav { background: white; border-bottom: 1px solid #e2e8f0; padding: 10px; overflow-x: auto; white-space: nowrap; }
        .nav-item {
            display: inline-block; padding: 8px 15px; margin-right: 5px;
            background: #f1f5f9; border-radius: 20px; cursor: pointer; font-size: 0.9rem;
        }
        .nav-item.active { background: var(--primary); color: white; }

        /* Tarjeta */
        main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .card-container { perspective: 1000px; width: 100%; max-width: 400px; height: 450px; }
        .card {
            width: 100%; height: 100%; position: relative; transition: transform 0.6s;
            transform-style: preserve-3d; cursor: pointer;
        }
        .card.is-flipped { transform: rotateY(180deg); }
        .face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: white; border-radius: 20px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            padding: 20px; box-sizing: border-box; text-align: center;
        }
        .face-back { transform: rotateY(180deg); }
        img { width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin-bottom: 20px; }
        
        .word { font-size: 2rem; font-weight: bold; color: var(--text); }
        .sentence { color: #64748b; margin-top: 10px; }

        /* Controles */
        .controls { display: flex; gap: 10px; width: 100%; max-width: 400px; margin-top: 20px; }
        .btn {
            flex: 1; padding: 15px; border: none; border-radius: 12px;
            color: white; font-weight: bold; cursor: pointer; font-size: 1rem;
        }
    </style>
</head>
<body>

    <div id="overlay">
        <h1>Refold English</h1>
        <p>Selecciona tu meta diaria:</p>
        <select id="words-per-day" style="padding: 10px; margin-bottom: 20px;">
            <option value="5">5 palabras</option>
            <option value="10" selected>10 palabras</option>
        </select>
        <button onclick="iniciar()" style="padding: 15px 40px; background: var(--primary); color: white; border: none; border-radius: 50px; cursor: pointer;">
            COMENZAR SESI칍N
        </button>
    </div>

    <nav id="menu-items"></nav>

    <main>
        <div id="streak-info">游댠 Racha: 0 d칤as</div>
        <div class="card-container">
            <div class="card" id="card" onclick="this.classList.toggle('is-flipped')">
                <div class="face">
                    <img id="q-img" src="" alt="Imagen">
                    <div id="q-word" class="word">...</div>
                    <div id="q-sent" class="sentence">...</div>
                </div>
                <div class="face face-back">
                    <div style="color: var(--primary); font-weight: bold; margin-bottom: 10px;">TRADUCCI칍N</div>
                    <div id="a-word" class="word" style="color: #10b981;">...</div>
                    <div id="a-sent" class="sentence">...</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" style="background: #64748b;" onclick="responder(false)">REPETIR</button>
            <button class="btn" style="background: #10b981;" onclick="responder(true)">ENTENDIDO</button>
        </div>
    </main>

    <script>
        // --- 1. BASE DE DATOS (DATA) ---
       const data = {
            1: [
                { id: "1-1", w: "Way", t: "Camino / Manera", s: "This is the way to the park.", st: "Este es el camino al parque.", i: "https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?w=400" },
                { id: "1-2", w: "Day", t: "D칤a", s: "Today is a sunny day.", st: "Hoy es un d칤a soleado.", i: "https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?w=400" },
                { id: "1-3", w: "Man", t: "Hombre", s: "The man is reading a book.", st: "El hombre est치 leyendo un libro.", i: "https://images.unsplash.com/photo-1503443207922-dff7d543fd0e?w=400" },
                { id: "1-4", w: "World", t: "Mundo", s: "I want to travel the world.", st: "Quiero viajar por el mundo.", i: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=400" },
                { id: "1-5", w: "Life", t: "Vida", s: "Life is beautiful.", st: "La vida es bella.", i: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400" },
                { id: "1-6", w: "Part", t: "Parte", s: "This is the best part.", st: "Esta es la mejor parte.", i: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400" },
                { id: "1-7", w: "Child", t: "Ni침o / Ni침a", s: "The child is playing.", st: "El ni침o est치 jugando.", i: "https://images.unsplash.com/photo-1503919545889-aef636e10ad4?w=400" },
                { id: "1-8", w: "Eye", t: "Ojo", s: "Close your eyes.", st: "Cierra los ojos.", i: "https://images.unsplash.com/photo-1544411047-c491584222f0?w=400" },
                { id: "1-9", w: "Woman", t: "Mujer", s: "She is a strong woman.", st: "Ella es una mujer fuerte.", i: "https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?w=400" },
                { id: "1-10", w: "Place", t: "Lugar", s: "This is a quiet place.", st: "Este es un lugar tranquilo.", i: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400" }
            ],
            2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [], 10: [],
            "repaso": [] // Mazo especial para fines de semana
        };

        // --- 2. VARIABLES GLOBALES ---
        let currentDeck = 1;
        let currentIndex = 0;
        let wordsPerDeck = 5;

        // --- 3. FUNCIONES DEL MOTOR ---
       function iniciar() {
            // 1. Obtener l칤mite diario (ej. 5 o 10 palabras)
            const select = document.getElementById('words-per-day');
            wordsPerDeck = parseInt(select.value);

            // 2. Detectar si es fin de semana (S치bado=6, Domingo=0)
            const hoy = new Date().getDay();
            const esFinde = (hoy === 0 || hoy === 6);

            if (esFinde) {
                alert("춰Modo Fin de Semana! Vamos a repasar palabras aprendidas.");
                currentDeck = "repaso";
                prepararRepaso(); // Funci칩n que busca lo que ya estudiaste
            } else {
                currentDeck = 1; // En semana, empezamos por el Mazo 1 o el que elijas
            }

            document.getElementById('overlay').style.display = 'none';
            crearMenu(esFinde);
            cargarTarjeta();
        }

        function prepararRepaso() {
            const aprendidas = JSON.parse(localStorage.getItem('refold_aprendidas')) || [];
            // Filtramos todas las palabras de todos los mazos que ya marcaste como "Entendido"
            let todas = [];
            for (let m in data) { if(m !== "repaso") todas = todas.concat(data[m]); }
            data["repaso"] = todas.filter(p => aprendidas.includes(p.id));
        }
      function cargarTarjeta() {
    // 1. Seleccionar el mazo (Normal o Repaso)
    let mazoCompleto = (currentDeck === "repaso") ? (data["repaso"] || []) : (data[currentDeck] || []);
    
    // 2. APLICAR EL FILTRO DE CANTIDAD (Aqu칤 es donde se arregla lo de las 5 palabras)
    // El slice corta desde la primera palabra hasta el n칰mero que elegiste (wordsPerDeck)
    const mazoReducido = mazoCompleto.slice(0, wordsPerDeck);
    
    const container = document.getElementById('card');

    // 3. Si terminamos las palabras del mazo cortado
    if (mazoReducido.length === 0 || currentIndex >= mazoReducido.length) {
        container.innerHTML = `
            <div class="face">
                <h2>Mazo ${currentDeck === 'repaso' ? 'de Repaso' : currentDeck} completado</h2>
                <p>Has terminado tus ${wordsPerDeck} palabras programadas.</p>
            </div>`;
        return;
    }

    const item = mazoReducido[currentIndex];
    container.classList.remove('is-flipped');

    // --- AUDIO AUTOM츼TICO ---
    const voz = new SpeechSynthesisUtterance(item.w);
    voz.lang = 'en-US'; 
    window.speechSynthesis.speak(voz);

    // --- CARGA DE DATOS ---
    const imgElement = document.getElementById('q-img');
    imgElement.src = item.i;
    imgElement.onerror = function() { this.src = "https://picsum.photos/400/300?grayscale"; };

    document.getElementById('q-word').innerText = item.w;
    document.getElementById('q-sent').innerText = item.s;
    document.getElementById('a-word').innerText = item.t;
    document.getElementById('a-sent').innerText = item.st;
    
    // Actualizar progreso visual
    const progressTag = document.getElementById('progress-tag');
    if (progressTag) {
        progressTag.innerText = `Tarjeta ${currentIndex + 1} de ${mazoReducido.length}`;
    }
}
        function crearMenu() {
            const menu = document.getElementById('menu-items');
            menu.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                const item = document.createElement('div');
                item.className = `nav-item ${currentDeck === i ? 'active' : ''}`;
                item.innerText = `Mazo ${i}`;
                item.onclick = () => {
                    currentDeck = i;
                    currentIndex = 0;
                    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                    item.classList.add('active');
                    cargarTarjeta();
                };
                menu.appendChild(item);
            }
        }
    </script>
</body>
</html>




