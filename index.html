<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refold 1000 - Mastery Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #05070a; --card: #111827; --accent: #6366f1; --success: #10b981; --text: #f8fafc; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Navegaci√≥n Lateral */
        nav { width: 280px; background: #0f172a; border-right: 2px solid #1e293b; padding: 20px; display: flex; flex-direction: column; height: 100vh; overflow-y: auto; }
        .nav-item { padding: 15px; border-radius: 12px; cursor: pointer; margin-bottom: 8px; color: #94a3b8; font-weight: 700; background: rgba(255,255,255,0.02); transition: 0.2s; }
        .nav-item.active { background: var(--accent); color: white; }
        .nav-item.special { border: 2px solid #fbbf24; color: #fbbf24; background: rgba(251, 191, 36, 0.1); }

        /* √Årea de Estudio */
        main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .card-container { perspective: 1200px; width: 340px; height: 480px; margin-bottom: 20px; }
        .card { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .card.is-flipped { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 40px; padding: 30px; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; background: var(--card); border: 1px solid rgba(255,255,255,0.1); }
        .face-back { transform: rotateY(180deg); background: #0f172a; border: 2px solid var(--accent); }

        .img-box { width: 100%; height: 220px; border-radius: 25px; overflow: hidden; margin-bottom: 25px; background: #000; }
        img { width: 100%; height: 100%; object-fit: cover; }

        .word { font-size: 32px; font-weight: 800; text-align: center; }
        .sentence { font-size: 16px; color: #94a3b8; margin-top: 15px; text-align: center; font-style: italic; }

        .controls { display: flex; gap: 15px; width: 340px; }
        .btn { flex: 1; padding: 20px; border: none; border-radius: 25px; font-weight: 800; cursor: pointer; color: white; }
        
        #overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div id="overlay">
        <h1 style="font-size: 2.5rem; margin-bottom: 20px;">Refold Mastery</h1>
        <button onclick="start()" style="padding: 20px 60px; border-radius: 50px; background: var(--accent); color: white; border: none; font-weight: 800; cursor: pointer;">CARGAR SISTEMA</button>
    </div>

    <nav id="menu">
        <div style="font-weight: 800; color: var(--accent); margin-bottom: 20px;">MIS MAZOS</div>
        <div id="deck-list"></div>
    </nav>

    <main>
        <div id="study-ui" style="display: flex; flex-direction: column; align-items: center;">
            <div id="streak-tag" style="color: #fbbf24; font-weight: 800; margin-bottom: 10px;">üî• Racha: 0 d√≠as</div>
            <div id="progress-tag" style="color: #475569; font-size: 0.9rem; margin-bottom: 10px;">Cargando...</div>
            
            <div class="card-container">
                <div class="card" id="card" onclick="this.classList.toggle('is-flipped')">
                    <div class="face">
                        <div class="img-box"><img id="q-img" src=""></div>
                        <div class="word" id="q-word">...</div>
                        <div class="sentence" id="q-sent">...</div>
                    </div>
                    <div class="face face-back">
                        <div style="color: var(--accent); font-weight: 800; margin-bottom: 15px;">ESPA√ëOL</div>
                        <div class="word" id="a-word" style="color: var(--success);">...</div>
                        <div class="sentence" id="a-sent" style="color: white;">...</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn" style="background: #334155;" onclick="answer(false)">REPETIR</button>
                <button class="btn" style="background: var(--accent);" onclick="answer(true)">LO TENGO</button>
            </div>
        </div>
    </main>

    <script>
        // BASE DE DATOS DE 1000 PALABRAS (ESTRUCTURA)
        const data = {
            "repaso_sabado": [], // No toques esto, se llena solo abajo
            1: [
                { w: "Actually", t: "En realidad", s: "Actually, it's very easy.", st: "En realidad, es muy f√°cil.", i: "https://picsum.photos/seed/1/400/300" },
                { w: "Development", t: "Desarrollo", s: "Focus on development.", st: "Enf√≥cate en el desarrollo.", i: "https://picsum.photos/seed/2/400/300" },
                { w: "Requirement", t: "Requisito", s: "It's a basic requirement.", st: "Es un requisito b√°sico.", i: "https://picsum.photos/seed/3/400/300" },
                { w: "Knowledge", t: "Conocimiento", s: "Knowledge is power.", st: "El conocimiento es poder.", i: "https://picsum.photos/seed/4/400/300" },
                { w: "Environment", t: "Medio ambiente", s: "Protect the environment.", st: "Protege el medio ambiente.", i: "https://picsum.photos/seed/5/400/300" },
                { w: "Improvement", t: "Mejora", s: "I see a big improvement.", st: "Veo una gran mejora.", i: "https://picsum.photos/seed/6/400/300" },
                { w: "Available", t: "Disponible", s: "Is this seat available?", st: "¬øEst√° este asiento disponible?", i: "https://picsum.photos/seed/7/400/300" },
                { w: "Challenge", t: "Desaf√≠o", s: "Accept the challenge.", st: "Acepta el desaf√≠o.", i: "https://picsum.photos/seed/8/400/300" },
                { w: "Growth", t: "Crecimiento", s: "The company has fast growth.", st: "La empresa tiene un crecimiento r√°pido.", i: "https://picsum.photos/seed/9/400/300" },
                { w: "Income", t: "Ingresos", s: "His income is very high.", st: "Sus ingresos son muy altos.", i: "https://picsum.photos/seed/10/400/300" }
            ],
            2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [], 10: []
        };

        // LLENADO AUTOM√ÅTICO DE LOS 10 MAZOS (1000 PALABRAS TOTAL)
        for (let m = 1; m <= 10; m++) {
            if (data[m].length < 100) {
                let inicio = data[m].length;
                for (let i = inicio; i < 100; i++) {
                    data[m].push({
                        w: `Word ${i + 1} (Mazo ${m})`,
                        t: `Palabra ${i + 1}`,
                        s: `Example sentence for word ${i + 1}.`,
                        st: `Oraci√≥n de ejemplo para la palabra ${i + 1}.`,
                        i: `https://picsum.photos/seed/m${m}img${i}/400/300`
                    });
                }
            }
        }

        // REPASO DEL S√ÅBADO: Toma las 100 del mazo 1 y 25 del mazo 2
        data.repaso_sabado = [...data[1], ...data[2].slice(0, 25)];

        // Rellenar din√°micamente el resto de mazos si est√°n vac√≠os
        for(let i=1; i<=10; i++) if(data[i].length === 0) data[i] = [...data.repaso_sabado];

        let state = JSON.parse(localStorage.getItem('refold_master_v1')) || {
            deck: "repaso_sabado", index: 0, racha: 0, fecha: "", historial: [0, 0, 0, 0, 0, 0, 0]
        };

        const synth = window.speechSynthesis;

        function start() {
            document.getElementById('overlay').style.display = 'none';
            // Desbloqueo de audio para Windows
            const silent = new SpeechSynthesisUtterance("");
            synth.speak(silent);
            
            updateMenu();
            render();
            checkStreak();
        }

        function updateMenu() {
            const list = document.getElementById('deck-list');
            list.innerHTML = "";
            const day = new Date().getDay();

            if(day === 6) { // S√°bado
                const btn = createBtn("‚≠ê REPASO S√ÅBADO", "repaso_sabado", true);
                list.appendChild(btn);
            }

            for(let i=1; i<=10; i++) {
                list.appendChild(createBtn("Mazo " + i, i, false));
            }
        }

        function createBtn(txt, id, special) {
            const d = document.createElement('div');
            d.className = `nav-item ${state.deck == id ? 'active' : ''} ${special ? 'special' : ''}`;
            d.innerText = txt;
            d.onclick = () => { state.deck = id; state.index = 0; updateMenu(); render(); };
            return d;
        }

        function render() {
            const currentDeck = data[state.deck] || data["repaso_sabado"];
            const item = currentDeck[state.index % currentDeck.length];

            document.getElementById('q-word').innerText = item.w;
            document.getElementById('q-sent').innerText = item.s;
            document.getElementById('a-word').innerText = item.t;
            document.getElementById('a-sent').innerText = item.st;
            document.getElementById('q-img').src = item.i;
            document.getElementById('card').classList.remove('is-flipped');
            document.getElementById('progress-tag').innerText = `Tarjeta ${state.index + 1} de ${currentDeck.length}`;

            // VOZ: Palabra + Oraci√≥n
            setTimeout(() => {
                synth.cancel();
                const u = new SpeechSynthesisUtterance(`${item.w}. ${item.s}`);
                u.lang = 'en-US';
                u.rate = 0.8;
                synth.speak(u);
            }, 500);
        }

        function answer(isCorrect) {
            if(isCorrect) {
                state.index++;
                const dIdx = (new Date().getDay() + 6) % 7;
                state.historial[dIdx]++;
                localStorage.setItem('refold_master_v1', JSON.stringify(state));
            }
            render();
        }

        function checkStreak() {
            const today = new Date().toDateString();
            if(state.fecha !== today) {
                state.racha++;
                state.fecha = today;
                localStorage.setItem('refold_master_v1', JSON.stringify(state));
            }
            document.getElementById('streak-tag').innerText = `üî• Racha: ${state.racha} d√≠as`;
        }
    </script>
</body>
</html>
